<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tareas Universitarias</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #e6f0ff, #d9e6ff);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #2c3e50;
        }
        .university-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .university-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            box-shadow: 
                6px 6px 12px #2980b9,
                -6px -6px 12px #3498db;
        }
        .university-logo i {
            color: white;
            font-size: 2.5rem;
        }
        .university-title {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            -webkit-background-clip: text;
            background-clip : text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }
        .university-subtitle {
            font-size: 1rem;
            color: #7f8c8d;
            font-weight: 500;
        }
        .container {
            width: 100%;
            max-width: 900px;
        }
        .main-card {
            background: #e6f0ff;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 
                12px 12px 24px #c2d4ff,
                -12px -12px 24px #ffffff;
            position: relative;
            overflow: hidden;
        }
        .main-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #3498db, #9b59b6, #e74c3c);
        }
        .title {
            font-size: 2.8rem;
            font-weight: 800;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            letter-spacing: 1.5px;
        }
        .user-info {
            text-align: right;
            margin-bottom: 20px;
            color: #3498db;
            font-weight: 600;
        }
        .logout-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                4px 4px 8px #c0392b,
                -4px -4px 8px #e74c3c;
        }
        .tasks-dropdown, .calendar-dropdown {
            background: #e6f0ff;
            border-radius: 20px;
            box-shadow: 
                8px 8px 16px #c2d4ff,
                -8px -8px 16px #ffffff;
            border: 2px solid rgba(52, 152, 219, 0.2);
            overflow: hidden;
            margin-bottom: 25px;
        }
        .dropdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 30px;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .dropdown-header:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        .dropdown-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .dropdown-title i {
            background: linear-gradient(135deg, #3498db, #2980b9);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
        }
        .dropdown-info {
            display: flex;
            align-items: center;
            gap: 20px;
            color: #7f8c8d;
            font-size: 1.1rem;
        }
        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        .info-number {
            color: #3498db;
            font-size: 1.2rem;
        }
        .dropdown-icon {
            transition: transform 0.3s ease;
            font-size: 1.5rem;
            color: #3498db;
        }
        .dropdown-icon.rotated {
            transform: rotate(180deg);
        }
        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }
        .dropdown-content.open {
            max-height: 1200px;
        }
        .priority-tabs {
            display: flex;
            gap: 12px;
            padding: 25px 30px 20px 30px;
            justify-content: center;
            flex-wrap: wrap;
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
        }
        .priority-tab {
            padding: 14px 24px;
            border: none;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 
                4px 4px 8px #c2d4ff,
                -4px -4px 8px #ffffff;
            position: relative;
            overflow: hidden;
        }
        .priority-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #9b59b6);
        }
        .priority-tab:hover {
            transform: translateY(-2px);
            box-shadow: 
                6px 6px 12px #c2d4ff,
                -6px -6px 12px #ffffff;
        }
        .priority-tab.active {
            transform: translateY(-2px);
            box-shadow: 
                8px 8px 16px #c2d4ff,
                -8px -8px 16px #ffffff;
        }
        .tab-all {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }
        .tab-high {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        .tab-medium {
            background: linear-gradient(135deg, #f39c12, #d35400);
            color: white;
        }
        .tab-low {
            background: linear-gradient(135deg, #27ae60, #219653);
            color: white;
        }
        .tab-counter {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 1px 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .add-task-section {
            padding: 30px 30px 20px 30px;
        }
        .new-task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
        }
        .new-task-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2980b9;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .new-task-title i {
            background: linear-gradient(135deg, #3498db, #2980b9);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .form-label {
            font-size: 0.95rem;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .form-label i {
            color: #3498db;
            font-size: 0.9rem;
        }
        .task-input, .task-select {
            padding: 16px 20px;
            border: none;
            border-radius: 15px;
            background: #e6f0ff;
            box-shadow: 
                inset 6px 6px 12px #c2d4ff,
                inset -6px -6px 12px #ffffff;
            font-size: 1rem;
            color: #2c3e50;
            outline: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .task-input:focus, .task-select:focus {
            box-shadow: 
                inset 8px 8px 16px #c2d4ff,
                inset -8px -8px 16px #ffffff;
            transform: scale(1.02);
        }
        .task-input::placeholder {
            color: #95a5a6;
            font-weight: 400;
        }
        .add-button {
            padding: 18px 35px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 
                6px 6px 12px #219653,
                -6px -6px 12px #34d399;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
            justify-content: center;
            width: fit-content;
        }
        .add-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                8px 8px 16px #219653,
                -8px -8px 16px #34d399;
        }
        .add-button:active {
            transform: translateY(0);
        }
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 25px;
            padding: 20px 30px 30px 30px;
        }
        .task-item {
            background: #e6f0ff;
            border-radius: 18px;
            padding: 25px;
            text-align: left;
            box-shadow: 
                6px 6px 12px #c2d4ff,
                -6px -6px 12px #ffffff;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-left: 4px solid #3498db;
        }
        .task-item:hover {
            transform: translateY(-3px);
            box-shadow: 
                10px 10px 20px #c2d4ff,
                -10px -10px 20px #ffffff;
        }
        .task-item.completed {
            opacity: 0.7;
            border-left: 4px solid #27ae60;
            background: #f8fbf8;
        }
        .task-item.completed .task-text {
            text-decoration: line-through;
            color: #7f8c8d;
        }
        .task-item.high-priority {
            border-left: 4px solid #e74c3c;
            background: linear-gradient(135deg, #ffe6e6, #fff);
        }
        .task-item.medium-priority {
            border-left: 4px solid #f39c12;
            background: linear-gradient(135deg, #fff8e6, #fff);
        }
        .task-item.low-priority {
            border-left: 4px solid #27ae60;
            background: linear-gradient(135deg, #e6fff8, #fff);
        }
        .task-content {
            flex: 1;
            min-width: 0;
        }
        .task-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .task-text {
            font-size: 1.2rem;
            color: #2c3e50;
            font-weight: 600;
            line-height: 1.5;
            word-break: break-word;
            padding-right: 15px;
        }
        .task-icon {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            margin-right: 15px;
            vertical-align: middle;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }
        .task-meta {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.7);
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        .meta-item i {
            font-size: 0.9rem;
        }
        .category-exam { color: #e74c3c; background: rgba(231, 76, 60, 0.1); }
        .category-homework { color: #3498db; background: rgba(52, 152, 219, 0.1); }
        .category-project { color: #9b59b6; background: rgba(155, 89, 182, 0.1); }
        .category-reading { color: #27ae60; background: rgba(39, 174, 96, 0.1); }
        .category-presentation { color: #f39c12; background: rgba(243, 156, 18, 0.1); }
        .priority-high { color: #e74c3c; }
        .priority-medium { color: #f39c12; }
        .priority-low { color: #27ae60; }
        .date-expired {
            color: #e74c3c;
            font-weight: 600;
        }
        .date-today {
            color: #f39c12;
            font-weight: 600;
        }
        .date-future {
            color: #27ae60;
            font-weight: 600;
        }
        .task-actions {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
            flex-direction: column;
        }
        .action-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            color: white;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 
                3px 3px 6px rgba(0,0,0,0.2),
                -3px -3px 6px rgba(255,255,255,0.8);
        }
        .complete-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }
        .delete-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .action-btn:hover {
            transform: scale(1.15);
            box-shadow: 
                5px 5px 10px rgba(0,0,0,0.3),
                -5px -5px 10px rgba(255,255,255,0.9);
        }
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #bdc3c7;
        }
        .empty-state p {
            font-size: 1.2rem;
            font-weight: 500;
        }
        /* Calendar Styles */
        .calendar-section {
            padding: 30px 30px 20px 30px;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
        }
        .calendar-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2980b9;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .calendar-title i {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        .nav-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 
                3px 3px 6px #2980b9,
                -3px -3px 6px #3498db;
            transition: all 0.2s ease;
        }
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 
                5px 5px 10px #2980b9,
                -5px -5px 10px #3498db;
        }
        .current-month {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin: 0 15px;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        .calendar-day-header {
            text-align: center;
            padding: 12px;
            font-weight: 700;
            color: #2c3e50;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
        }
        .calendar-day {
            position: relative;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #e6f0ff;
            border-radius: 12px;
            box-shadow: 
                3px 3px 6px #c2d4ff,
                -3px -3px 6px #ffffff;
            font-size: 0.95rem;
            font-weight: 600;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .calendar-day:hover {
            transform: translateY(-2px);
            box-shadow: 
                5px 5px 10px #c2d4ff,
                -5px -5px 10px #ffffff;
        }
        .calendar-day.other-month {
            color: #bdc3c7;
            opacity: 0.6;
        }
        .calendar-day.today {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            box-shadow: 
                3px 3px 6px #2980b9,
                -3px -3px 6px #3498db;
        }
        .calendar-day.has-tasks {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            box-shadow: 
                3px 3px 6px #e67e22,
                -3px -3px 6px #f39c12;
        }
        .task-count {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(255, 255, 255, 0.8);
            color: #e74c3c;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 10px;
        }
        /* Day Detail Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: #e6f0ff;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 
                12px 12px 24px #c2d4ff,
                -12px -12px 24px #ffffff;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(50px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.open .modal-content {
            transform: translateY(0);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.5);
        }
        .modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .modal-title i {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        .close-modal {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 
                3px 3px 6px #c0392b,
                -3px -3px 6px #e74c3c;
            transition: all 0.2s ease;
        }
        .close-modal:hover {
            transform: scale(1.1);
            box-shadow: 
                5px 5px 10px #c0392b,
                -5px -5px 10px #e74c3c;
        }
        .day-tasks-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .day-task-item {
            background: #e6f0ff;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 
                5px 5px 10px #c2d4ff,
                -5px -5px 10px #ffffff;
            transition: all 0.2s ease;
            border-left: 3px solid #3498db;
        }
        .day-task-item:hover {
            transform: translateY(-2px);
            box-shadow: 
                8px 8px 16px #c2d4ff,
                -8px -8px 16px #ffffff;
        }
        .day-task-item.high-priority {
            border-left: 3px solid #e74c3c;
            background: linear-gradient(135deg, #ffe6e6, #fff);
        }
        .day-task-item.medium-priority {
            border-left: 3px solid #f39c12;
            background: linear-gradient(135deg, #fff8e6, #fff);
        }
        .day-task-item.low-priority {
            border-left: 3px solid #27ae60;
            background: linear-gradient(135deg, #e6fff8, #fff);
        }
        .day-task-text {
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 10px;
            word-break: break-word;
        }
        .day-task-meta {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .day-meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.7);
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        .day-meta-item i {
            font-size: 0.85rem;
        }
        .no-tasks-message {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .no-tasks-message i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #bdc3c7;
        }
        @media (max-width: 768px) {
            .main-card {
                padding: 30px 20px;
            }
            .title {
                font-size: 2.2rem;
            }
            .dropdown-header {
                padding: 20px 25px;
            }
            .dropdown-title {
                font-size: 1.5rem;
            }
            .form-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .priority-tabs {
                justify-content: center;
            }
            .add-button {
                padding: 16px 25px;
                font-size: 1rem;
            }
            .task-item {
                flex-direction: column;
                align-items: stretch;
                padding: 20px;
            }
            .task-actions {
                align-self: flex-end;
                margin-top: 15px;
                flex-direction: row;
            }
            .task-text {
                font-size: 1.1rem;
            }
            .task-meta {
                justify-content: flex-start;
            }
            .task-list, .calendar-section {
                padding: 20px 25px 25px 25px;
            }
            .add-task-section {
                padding: 25px 25px 15px 25px;
            }
            .calendar-grid {
                gap: 4px;
            }
            .calendar-day {
                font-size: 0.8rem;
            }
            .modal-content {
                padding: 30px;
                margin: 20px;
            }
            .modal-title {
                font-size: 1.5rem;
            }
        }
        @media (max-width: 480px) {
            .main-card {
                padding: 25px 15px;
            }
            .title {
                font-size: 1.8rem;
            }
            .university-logo {
                width: 60px;
                height: 60px;
            }
            .university-logo i {
                font-size: 2rem;
            }
            .dropdown-header {
                padding: 18px 20px;
            }
            .dropdown-title {
                font-size: 1.3rem;
            }
            .dropdown-title i {
                width: 35px;
                height: 35px;
                font-size: 1.2rem;
            }
            .dropdown-info {
                font-size: 0.9rem;
                gap: 15px;
            }
            .info-number {
                font-size: 1rem;
            }
            .task-text {
                font-size: 1rem;
            }
            .action-btn {
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
            .meta-item {
                font-size: 0.8rem;
                padding: 4px 8px;
            }
            .priority-tab {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            .new-task-title, .calendar-title {
                font-size: 1.2rem;
            }
            .current-month {
                font-size: 1.1rem;
            }
            .nav-btn {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            .modal-content {
                padding: 25px 20px;
            }
            .day-task-text {
                font-size: 1rem;
            }
            .close-modal {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
        }
        /* Animation for tasks appearing */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .task-item {
            animation: fadeIn 0.4s ease-out forwards;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="university-header">
            <div class="university-logo">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h2 class="university-title">Sistema de Gestión Académica</h2>
            <p class="university-subtitle">Organiza tus tareas universitarias</p>
        </div>
        <div class="main-card">
            <div class="user-info">
                <span id="welcomeMessage">Bienvenido</span>
                <button class="logout-btn" id="logoutBtn">Cerrar Sesión</button>
            </div>
            <h1 class="title">Panel de Control</h1>
            <div class="tasks-dropdown">
                <div class="dropdown-header" id="tasksDropdownHeader">
                    <div class="dropdown-title">
                        <i class="fas fa-tasks"></i>
                        <span>Tareas</span>
                    </div>
                    <div class="dropdown-info">
                        <div class="info-item">
                            <i class="fas fa-list"></i>
                            <span class="info-number" id="totalTasksHeader">0</span>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-exclamation-circle"></i>
                            <span class="info-number" id="pendingTasksHeader">0</span>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-icon" id="tasksDropdownIcon"></i>
                </div>
                <div class="dropdown-content" id="tasksDropdownContent">
                    <div class="priority-tabs">
                        <button class="priority-tab tab-all active" data-priority="all">
                            <i class="fas fa-list"></i> Todas
                            <span class="tab-counter" id="counter-all">0</span>
                        </button>
                        <button class="priority-tab tab-high" data-priority="high">
                            <i class="fas fa-exclamation-circle"></i> Alta
                            <span class="tab-counter" id="counter-high">0</span>
                        </button>
                        <button class="priority-tab tab-medium" data-priority="medium">
                            <i class="fas fa-exclamation"></i> Media
                            <span class="tab-counter" id="counter-medium">0</span>
                        </button>
                        <button class="priority-tab tab-low" data-priority="low">
                            <i class="fas fa-check-circle"></i> Baja
                            <span class="tab-counter" id="counter-low">0</span>
                        </button>
                    </div>
                    <div class="add-task-section">
                        <div class="new-task-header">
                            <div class="new-task-title">
                                <i class="fas fa-plus"></i>
                                <span>Nueva Tarea</span>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-tasks"></i>
                                    Tarea
                                </label>
                                <input type="text" class="task-input" id="newTaskInput" placeholder="Escribe tu tarea...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-calendar"></i>
                                    Fecha de vencimiento
                                </label>
                                <input type="date" class="task-input" id="dueDateInput">
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-tag"></i>
                                    Categoría
                                </label>
                                <select class="task-select" id="categoryInput">
                                    <option value="">Seleccionar...</option>
                                    <option value="exam">Examen</option>
                                    <option value="homework">Tarea</option>
                                    <option value="project">Proyecto</option>
                                    <option value="reading">Lectura</option>
                                    <option value="presentation">Presentación</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-exclamation-circle"></i>
                                    Prioridad
                                </label>
                                <select class="task-select" id="priorityInput">
                                    <option value="low">Baja</option>
                                    <option value="medium" selected>Media</option>
                                    <option value="high">Alta</option>
                                </select>
                            </div>
                        </div>
                        <button class="add-button" id="addTaskBtn">
                            <i class="fas fa-plus"></i> Agregar Tarea
                        </button>
                    </div>
                    <div class="task-list" id="taskList">
                        <!-- Tasks will be generated by JavaScript -->
                    </div>
                </div>
            </div>
            <div class="calendar-dropdown">
                <div class="dropdown-header" id="calendarDropdownHeader">
                    <div class="dropdown-title">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendario</span>
                    </div>
                    <div class="dropdown-info">
                        <div class="info-item">
                            <i class="fas fa-calendar-day"></i>
                            <span class="info-number" id="tasksThisMonth">0</span>
                        </div>
                    </div>
                    <i class="fas fa-chevron-down dropdown-icon" id="calendarDropdownIcon"></i>
                </div>
                <div class="dropdown-content" id="calendarDropdownContent">
                    <div class="calendar-section">
                        <div class="calendar-header">
                            <div class="calendar-title">
                                <i class="fas fa-calendar"></i>
                                <span>Vista Mensual</span>
                            </div>
                            <div class="calendar-nav">
                                <button class="nav-btn" id="prevMonth">←</button>
                                <span class="current-month" id="currentMonth">Enero 2024</span>
                                <button class="nav-btn" id="nextMonth">→</button>
                            </div>
                        </div>
                        <div class="calendar-grid" id="calendarGrid">
                            <!-- Calendar will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal for Day Tasks -->
    <div class="modal-overlay" id="dayTasksModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-tasks"></i>
                    <span id="modalDateTitle">Tareas del 15 de Enero</span>
                </div>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="day-tasks-list" id="dayTasksList">
                <!-- Tasks for the selected day will be displayed here -->
            </div>
        </div>
    </div>
    <script>
        // Check for login session on page load
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) {
                // If not logged in, redirect to login page
                window.location.href = 'login.html';
                return; // Stop execution of the rest of the script
            }
            
            // If logged in, display welcome message
            document.getElementById('welcomeMessage').textContent = `Bienvenido, ${currentUser.name} (${currentUser.role})`;
            
            // Load tasks for current user
            loadTasks();
        });

        // Logout function
        document.getElementById('logoutBtn').addEventListener('click', function() {
            // Clear user session from localStorage
            localStorage.removeItem('currentUser');
            // Redirect to login page
            window.location.href = 'login.html';
        });

        // DOM elements
        const taskList = document.getElementById('taskList');
        const newTaskInput = document.getElementById('newTaskInput');
        const dueDateInput = document.getElementById('dueDateInput');
        const categoryInput = document.getElementById('categoryInput');
        const priorityInput = document.getElementById('priorityInput');
        const addTaskBtn = document.getElementById('addTaskBtn');
        const totalTasksHeader = document.getElementById('totalTasksHeader');
        const pendingTasksHeader = document.getElementById('pendingTasksHeader');
        const tasksThisMonth = document.getElementById('tasksThisMonth');
        const priorityTabs = document.querySelectorAll('.priority-tab');
        const counterAll = document.getElementById('counter-all');
        const counterHigh = document.getElementById('counter-high');
        const counterMedium = document.getElementById('counter-medium');
        const counterLow = document.getElementById('counter-low');
        const tasksDropdownHeader = document.getElementById('tasksDropdownHeader');
        const tasksDropdownContent = document.getElementById('tasksDropdownContent');
        const tasksDropdownIcon = document.getElementById('tasksDropdownIcon');
        const calendarDropdownHeader = document.getElementById('calendarDropdownHeader');
        const calendarDropdownContent = document.getElementById('calendarDropdownContent');
        const calendarDropdownIcon = document.getElementById('calendarDropdownIcon');
        const calendarGrid = document.getElementById('calendarGrid');
        const currentMonthEl = document.getElementById('currentMonth');
        const prevMonthBtn = document.getElementById('prevMonth');
        const nextMonthBtn = document.getElementById('nextMonth');
        const dayTasksModal = document.getElementById('dayTasksModal');
        const closeModalBtn = document.getElementById('closeModal');
        const modalDateTitle = document.getElementById('modalDateTitle');
        const dayTasksList = document.getElementById('dayTasksList');
        
        // Set today as default date
        const today = new Date().toISOString().split('T')[0];
        dueDateInput.value = today;
        
        // Category and priority labels
        const categoryLabels = {
            exam: "Examen",
            homework: "Tarea",
            project: "Proyecto",
            reading: "Lectura",
            presentation: "Presentación"
        };
        const priorityLabels = {
            low: "Baja",
            medium: "Media",
            high: "Alta"
        };
        
        // Current priority filter and calendar date
        let currentPriority = 'all';
        let currentCalendarDate = new Date();
        let selectedDateForModal = null;
        let currentUserId = null;
        
        // Dropdown toggle functionality
        tasksDropdownHeader.addEventListener('click', () => {
            tasksDropdownContent.classList.toggle('open');
            tasksDropdownIcon.classList.toggle('rotated');
        });
        calendarDropdownHeader.addEventListener('click', () => {
            calendarDropdownContent.classList.toggle('open');
            calendarDropdownIcon.classList.toggle('rotated');
            if (calendarDropdownContent.classList.contains('open')) {
                renderCalendar();
            }
        });
        
        // Modal functionality
        closeModalBtn.addEventListener('click', () => {
            dayTasksModal.classList.remove('open');
        });
        dayTasksModal.addEventListener('click', (e) => {
            if (e.target === dayTasksModal) {
                dayTasksModal.classList.remove('open');
            }
        });
        
        // Function to get current user ID
        function getCurrentUserId() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            return currentUser ? currentUser.id : null;
        }
        
        // Function to load tasks from the database
        async function loadTasks() {
            currentUserId = getCurrentUserId();
            if (!currentUserId) {
                alert('No se pudo cargar las tareas. Por favor inicia sesión.');
                window.location.href = 'login.html';
                return;
            }
            
            try {
                const res = await fetch(`/.netlify/functions/get-tasks?userId=${currentUserId}`);
                const tasks = await res.json();
                
                // Clear the task list
                taskList.innerHTML = '';
                
                // Create elements for each task
                tasks.forEach(task => {
                    const taskElement = createTaskElement(task, task.completed);
                    taskList.appendChild(taskElement);
                });
                
                updateAll();
            } catch (error) {
                console.error('Error al cargar tareas:', error);
                alert('Error al cargar las tareas. Inténtalo de nuevo.');
            }
        }
        
        // Function to add a new task to the database
        async function addNewTask() {
            const taskText = newTaskInput.value.trim();
            const dueDate = dueDateInput.value;
            const category = categoryInput.value;
            const priority = priorityInput.value;
            
            if (taskText === '' || dueDate === '' || category === '') {
                alert('Por favor completa todos los campos obligatorios.');
                return;
            }
            
            try {
                const res = await fetch('/.netlify/functions/add-task', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: currentUserId,
                        text: taskText,
                        dueDate: dueDate,
                        category: category,
                        priority: priority
                    })
                });
                
                const newTask = await res.json();
                
                // Add to UI
                const taskElement = createTaskElement(newTask, false);
                taskList.prepend(taskElement);
                
                // Clear form
                newTaskInput.value = '';
                dueDateInput.value = today;
                categoryInput.value = '';
                priorityInput.value = 'medium';
                newTaskInput.focus();
                
                updateAll();
            } catch (error) {
                console.error('Error al agregar tarea:', error);
                alert('Error al agregar la tarea. Inténtalo de nuevo.');
            }
        }
        
        // Function to toggle task completion in the database
        async function toggleTaskCompletion(taskElement, taskData) {
            const isCompleted = taskElement.classList.contains('completed');
            taskElement.classList.toggle('completed', !isCompleted);
            
            try {
                const res = await fetch('/.netlify/functions/update-task', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        taskId: taskData.id,
                        completed: !isCompleted
                    })
                });
                
                const updatedTask = await res.json();
                
                // Update the task element with the new data if needed
                // In this case, we only need to update the class
                updateAll();
            } catch (error) {
                console.error('Error al actualizar tarea:', error);
                // Revert the visual change
                taskElement.classList.toggle('completed', isCompleted);
                alert('Error al actualizar la tarea. Inténtalo de nuevo.');
            }
        }
        
        // Function to delete task from the database
        async function deleteTask(taskElement) {
            const taskId = taskElement.dataset.id;
            taskElement.style.opacity = '0';
            taskElement.style.transform = 'translateY(-20px)';
            
            try {
                const res = await fetch(`/.netlify/functions/delete-task?taskId=${taskId}`, {
                    method: 'DELETE'
                });
                
                const data = await res.json();
                
                if (data.success) {
                    setTimeout(() => {
                        taskElement.remove();
                        updateAll();
                    }, 300);
                } else {
                    throw new Error('Failed to delete task');
                }
            } catch (error) {
                console.error('Error al eliminar tarea:', error);
                taskElement.style.opacity = '1';
                taskElement.style.transform = 'translateY(0)';
                alert('Error al eliminar la tarea. Inténtalo de nuevo.');
            }
        }
        
        // Function to create task elements
        function createTaskElement(taskData, isCompleted = false) {
            const taskItem = document.createElement('div');
            taskItem.className = `task-item ${isCompleted ? 'completed' : ''} ${taskData.priority}-priority`;
            // store metadata on the element so calendar/modal can read it reliably
            taskItem.dataset.priority = taskData.priority;
            taskItem.dataset.dueDate = taskData.dueDate;
            taskItem.dataset.category = taskData.category || '';
            taskItem.dataset.text = taskData.text || '';
            taskItem.dataset.id = taskData.id; // Store task ID
            
            const taskContent = document.createElement('div');
            taskContent.className = 'task-content';
            
            const taskHeader = document.createElement('div');
            taskHeader.className = 'task-header';
            
            const taskTextEl = document.createElement('div');
            taskTextEl.className = 'task-text';
            taskTextEl.innerHTML = `<span class="task-icon"><i class="fas fa-book"></i></span>${taskData.text}`;
            
            const taskMeta = document.createElement('div');
            taskMeta.className = 'task-meta';
            
            // Due date
            const dateMeta = document.createElement('div');
            dateMeta.className = `meta-item ${getDateClass(taskData.dueDate)}`;
            dateMeta.innerHTML = `<i class="fas fa-calendar"></i> ${formatDate(taskData.dueDate)}`;
            
            // Category
            const categoryMeta = document.createElement('div');
            categoryMeta.className = `meta-item category-${taskData.category}`;
            categoryMeta.innerHTML = `<i class="fas fa-tag"></i> ${categoryLabels[taskData.category] || ''}`;
            
            // Priority
            const priorityMeta = document.createElement('div');
            priorityMeta.className = `meta-item priority-${taskData.priority}`;
            priorityMeta.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${priorityLabels[taskData.priority]}`;
            
            taskMeta.appendChild(dateMeta);
            taskMeta.appendChild(categoryMeta);
            taskMeta.appendChild(priorityMeta);
            
            taskHeader.appendChild(taskTextEl);
            taskContent.appendChild(taskHeader);
            taskContent.appendChild(taskMeta);
            
            const taskActions = document.createElement('div');
            taskActions.className = 'task-actions';
            
            const completeBtn = document.createElement('button');
            completeBtn.className = 'action-btn complete-btn';
            completeBtn.innerHTML = isCompleted ? '<i class="fas fa-undo"></i>' : '<i class="fas fa-check"></i>';
            completeBtn.onclick = () => toggleTaskCompletion(taskItem, taskData);
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'action-btn delete-btn';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.onclick = () => deleteTask(taskItem);
            
            taskActions.appendChild(completeBtn);
            taskActions.appendChild(deleteBtn);
            
            taskItem.appendChild(taskContent);
            taskItem.appendChild(taskActions);
            
            return taskItem;
        }
        
        // Function to create day task elements for modal
        function createDayTaskElement(taskData) {
            const taskItem = document.createElement('div');
            taskItem.className = `day-task-item ${taskData.priority}-priority`;
            
            const taskText = document.createElement('div');
            taskText.className = 'day-task-text';
            taskText.textContent = taskData.text;
            
            const taskMeta = document.createElement('div');
            taskMeta.className = 'day-task-meta';
            
            // Category
            const categoryMeta = document.createElement('div');
            categoryMeta.className = `day-meta-item category-${taskData.category}`;
            categoryMeta.innerHTML = `<i class="fas fa-tag"></i> ${categoryLabels[taskData.category]}`;
            
            // Priority
            const priorityMeta = document.createElement('div');
            priorityMeta.className = `day-meta-item priority-${taskData.priority}`;
            priorityMeta.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${priorityLabels[taskData.priority]}`;
            
            taskMeta.appendChild(categoryMeta);
            taskMeta.appendChild(priorityMeta);
            
            taskItem.appendChild(taskText);
            taskItem.appendChild(taskMeta);
            
            return taskItem;
        }
        
        // Function to get date class
        function getDateClass(dueDate) {
            const today = new Date();
            const due = new Date(dueDate);
            const diffTime = due - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) return 'date-expired';
            if (diffDays === 0) return 'date-today';
            return 'date-future';
        }
        
        // Function to format date for display
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }
        
        // Function to format date for modal title
        function formatDateForModal(dateString) {
            const date = new Date(dateString);
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                              'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            return `${date.getDate()} de ${monthNames[date.getMonth()]} de ${date.getFullYear()}`;
        }
        
        // Function to sort tasks by priority (High -> Medium -> Low)
        function sortTasksByPriority() {
            const tasks = Array.from(taskList.children).filter(child => !child.classList.contains('empty-state'));
            tasks.sort((a, b) => {
                const priorityOrder = { high: 0, medium: 1, low: 2 };
                return priorityOrder[a.dataset.priority] - priorityOrder[b.dataset.priority];
            });
            tasks.forEach(task => taskList.appendChild(task));
        }
        
        // Function to update counters
        function updateCounters() {
            const allTasks = taskList.querySelectorAll('.task-item:not(.empty-state)');
            const highCount = Array.from(allTasks).filter(task => task.dataset.priority === 'high').length;
            const mediumCount = Array.from(allTasks).filter(task => task.dataset.priority === 'medium').length;
            const lowCount = Array.from(allTasks).filter(task => task.dataset.priority === 'low').length;
            const totalCount = allTasks.length;
            const pendingCount = Array.from(allTasks).filter(task => !task.classList.contains('completed')).length;
            
            counterAll.textContent = totalCount;
            counterHigh.textContent = highCount;
            counterMedium.textContent = mediumCount;
            counterLow.textContent = lowCount;
            
            // Update header counters
            totalTasksHeader.textContent = totalCount;
            pendingTasksHeader.textContent = pendingCount;
        }
        
        // Function to apply priority filter
        function applyPriorityFilter() {
            const taskItems = Array.from(taskList.querySelectorAll('.task-item'));
            let visibleCount = 0;
            taskItems.forEach(item => {
                const shouldShow = (currentPriority === 'all') || (item.dataset.priority === currentPriority);
                item.style.display = shouldShow ? 'flex' : 'none';
                if (shouldShow) visibleCount++;
            });
            
            // Manage empty-state element without wiping out existing tasks
            let emptyEl = taskList.querySelector('.empty-state');
            if (visibleCount === 0) {
                if (!emptyEl) {
                    emptyEl = document.createElement('div');
                    emptyEl.className = 'empty-state';
                    emptyEl.innerHTML = `
                        <i class="fas fa-clipboard-list"></i>
                        <p>No hay tareas ${currentPriority !== 'all' ? `de ${priorityLabels[currentPriority]} prioridad` : ''}</p>
                    `;
                    taskList.appendChild(emptyEl);
                }
            } else {
                if (emptyEl) emptyEl.remove();
            }
        }
        
        // Function to update everything
        function updateAll() {
            sortTasksByPriority();
            updateCounters();
            applyPriorityFilter();
            renderCalendar(); // Update calendar when tasks change
        }
        
        // Priority tab event listeners
        priorityTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Update active tab
                priorityTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update current priority
                currentPriority = tab.dataset.priority;
                
                // Update everything
                updateAll();
            });
        });
        
        // Calendar functions
        function getDaysInMonth(year, month) {
            return new Date(year, month + 1, 0).getDate();
        }
        
        function getFirstDayOfMonth(year, month) {
            return new Date(year, month, 1).getDay();
        }
        
        function getTasksForDate(dateString) {
            const allTasks = taskList.querySelectorAll('.task-item:not(.empty-state)');
            // return DOM elements that match the date
            return Array.from(allTasks).filter(task => task.dataset.dueDate === dateString);
        }
        
        function renderCalendar() {
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            // Update month display
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                              'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            currentMonthEl.textContent = `${monthNames[month]} ${year}`;
            
            // Clear calendar
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayNames = ['Dom', 'Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb'];
            dayNames.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Get days in month and first day
            const daysInMonth = getDaysInMonth(year, month);
            const firstDay = getFirstDayOfMonth(year, month);
            
            // Add empty cells for days before the first day
            for (let i = 0; i < firstDay; i++) {
                const prevMonthDate = new Date(year, month, 0 - i);
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day other-month';
                dayCell.textContent = prevMonthDate.getDate();
                calendarGrid.appendChild(dayCell);
            }
            
            // Count tasks for this month
            let monthTaskCount = 0;
            
            // Add cells for current month
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateString = date.toISOString().split('T')[0];
                const tasks = getTasksForDate(dateString);
                const hasTasks = tasks.length > 0;
                monthTaskCount += tasks.length;
                
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                if (hasTasks) {
                    dayCell.classList.add('has-tasks');
                }
                if (date.toDateString() === today.toDateString()) {
                    dayCell.classList.add('today');
                }
                dayCell.textContent = day;
                dayCell.dataset.date = dateString;
                
                if (hasTasks) {
                    const taskCount = document.createElement('div');
                    taskCount.className = 'task-count';
                    taskCount.textContent = tasks.length;
                    dayCell.appendChild(taskCount);
                }
                
                dayCell.addEventListener('click', () => {
                    if (hasTasks) {
                        showDayTasksModal(dateString, tasks);
                    }
                });
                
                calendarGrid.appendChild(dayCell);
            }
            
            // Add empty cells for days after the last day
            const totalCells = calendarGrid.children.length;
            const remainingCells = 42 - totalCells; // 6 rows x 7 days = 42
            for (let i = 1; i <= remainingCells; i++) {
                const nextMonthDate = new Date(year, month + 1, i);
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day other-month';
                dayCell.textContent = nextMonthDate.getDate();
                calendarGrid.appendChild(dayCell);
            }
            
            // Update tasks this month counter
            tasksThisMonth.textContent = monthTaskCount;
        }
        
        // Function to show day tasks modal
        function showDayTasksModal(dateString, tasks) {
            selectedDateForModal = dateString;
            const formattedDate = formatDateForModal(dateString);
            modalDateTitle.textContent = `Tareas del ${formattedDate}`;
            
            // Clear previous tasks
            dayTasksList.innerHTML = '';
            
            if (tasks.length === 0) {
                dayTasksList.innerHTML = `
                    <div class="no-tasks-message">
                        <i class="fas fa-calendar-check"></i>
                        <p>No hay tareas para este día</p>
                    </div>
                `;
            } else {
                tasks.forEach(taskElem => {
                    // read data directly from dataset (set earlier in createTaskElement)
                    const taskData = {
                        text: taskElem.dataset.text || taskElem.querySelector('.task-text')?.textContent || '',
                        category: taskElem.dataset.category || '',
                        priority: taskElem.dataset.priority || 'medium'
                    };
                    const taskElement = createDayTaskElement(taskData);
                    dayTasksList.appendChild(taskElement);
                });
            }
            
            dayTasksModal.classList.add('open');
        }
        
        // Calendar navigation
        prevMonthBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
            renderCalendar();
        });
        
        nextMonthBtn.addEventListener('click', () => {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
            renderCalendar();
        });
        
        // Event listeners
        addTaskBtn.addEventListener('click', addNewTask);
        newTaskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                addNewTask();
            }
        });
    </script>
</body>
</html>


